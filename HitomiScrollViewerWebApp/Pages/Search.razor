@page "/search"
@using HitomiScrollViewerData
@inject TagService TagService
@inject TagFilterService TagFilterService
@inject ISnackbar Snackbar
@inject IDialogService DialogService

<PageTitle>Search</PageTitle>

<div style="display: grid; grid-template-columns: 75% 25%; padding: 32px;">
    <div class="gap-4" style="grid-column: 1; display: grid; grid-template-rows: auto 1fr;">
        <MudPaper Class="d-flex flex-column pa-8 gap-4" Style="grid-row: 1;">
            <div>
                <TagFilterEditor @ref="_tagFilterEditor"
                                 TagFilters="@TagFilters"
                                 SelectedTagFilterChanged="@SelectedTagFilterChanged"
                                 OnCreateButtonClicked="@CreateTagFilter"
                                 OnRenameButtonClicked="@RenameTagFilter"
                                 OnSaveButtonClicked="@(() => SaveTagFilter(_tagFilterEditor.CurrentTagFilter))" />
            </div>
            <div class="d-flex justify-space-between">
                <div class="d-flex gap-4">
                    <MudButton Color="Color.Primary"
                               EndIcon="@Icons.Material.Filled.Clear"
                               OnClick="ClearAllTags"
                               Disabled="@(_tagFilterEditor?.CurrentTagFilter == null)">
                        Clear All Tags
                    </MudButton>
                    <MudButton Color="Color.Primary"
                               EndIcon="@Icons.Material.Filled.Refresh"
                               OnClick="LoadTags"
                               Disabled="@(_tagFilterEditor?.CurrentTagFilter == null)">
                        Reload Tags
                    </MudButton>
                </div>
                <div>
                    <MudSwitch T="bool" Label="Auto save" Color="Color.Primary" @bind-Value="_isAutoSaveEnabled" />
                </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(@TAG_CATEGORIES.Length, 1fr);
                        border: @BORDER_SOLID_PRIMARY; border-radius: inherit; min-height: 30dvh">
                @for (int i = 0; i < _tagSearchChipSetModels.Length; i++) {
                    <div style="grid-column: @(i + 1); border-right: @(i < TAG_CATEGORIES.Length - 1 ? BORDER_SOLID_PRIMARY : "none");
                                max-height: 100%; overflow: hidden">
                        <TagSearchChipSet Model="_tagSearchChipSetModels[i]" />
                    </div>
                }
            </div>
        </MudPaper>
        <MudPaper Class="d-flex gap-4" Style="grid-row: 2; min-height: 30dvh">
            <TagFilterSelector ChipModels="@_includeTagFilterChipModels" HeaderText="Include" HeaderTextColor="Color.Success" />
            <MudDivider Vertical="true" Class="my-6" FlexItem="true" />
            <TagFilterSelector ChipModels="@_excludeTagFilterChipModels" HeaderText="Exclude" HeaderTextColor="Color.Error" />
        </MudPaper>
    </div>
    <div style="display: grid; grid-column: 2; grid-template-rows: auto 1fr 1fr;">
    </div>
</div>